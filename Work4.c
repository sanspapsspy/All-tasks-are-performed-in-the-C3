#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>
#include <math.h>
#include <locale.h>

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –≤–≤–æ–¥–∞
int get_valid_integer(int min, int max) {
    char input[100];
    int value;

    while (1) {
        if (fgets(input, sizeof(input), stdin) == NULL) {
            printf("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞.\n");
            return -1;
        }

        // –£–¥–∞–ª—è–µ–º —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
        input[strcspn(input, "\n")] = '\0';

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –≤–≤–æ–¥ —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
        int valid = 1;
        for (int i = 0; input[i] != '\0'; i++) {
            if (input[i] < '0' || input[i] > '9') {
                valid = 0;
                break;
            }
        }

        if (!valid) {
            printf("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç %d –¥–æ %d: ", min, max);
            continue;
        }

        value = atoi(input);
        if (value < min || value > max) {
            printf("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç %d –¥–æ %d: ", min, max);
            continue;
        }

        break;
    }

    return value;
}

int main() {
    setlocale(LC_ALL, ("Rus"));
    int N, secret_number, guess, attempts = 0;
    int low, high;
    char strategy_choice[3]; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –±—É—Ñ–µ—Ä –¥–ª—è —á—Ç–µ–Ω–∏—è –≤–≤–æ–¥–∞

    srand(time(NULL));

    printf("=== –ò–≥—Ä–∞ '–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ' ===\n");

    // –ü–æ–ª—É—á–∞–µ–º N –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    printf("–í–≤–µ–¥–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ N (–æ—Ç 1 –∏ –±–æ–ª—å—à–µ): ");
    N = get_valid_integer(1, 1000000);

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —á–∏—Å–ª–æ
    secret_number = rand() % N + 1;

    printf("–Ø –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ %d.\n", N);
    printf("–•–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é? (y/n): ");

    // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    while (1) {
        if (fgets(strategy_choice, sizeof(strategy_choice), stdin) == NULL) {
            printf("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞.\n");
            return 1;
        }
        // –£–¥–∞–ª—è–µ–º —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
        if (strategy_choice[strlen(strategy_choice) - 1] == '\n') {
            strategy_choice[strlen(strategy_choice) - 1] = '\0';
        }

        if (strategy_choice[0] == 'y' || strategy_choice[0] == 'Y' ||
            strategy_choice[0] == 'n' || strategy_choice[0] == 'N') {
            break;
        }
        printf("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ 'y' –¥–ª—è –¥–∞ –∏–ª–∏ 'n' –¥–ª—è –Ω–µ—Ç: ");
    }

    if (strategy_choice[0] == 'y' || strategy_choice[0] == 'Y') {
        printf("–ò—Å–ø–æ–ª—å–∑—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–≥–∞–¥—ã–≤–∞–Ω–∏—è.\n");
        printf("–ó–∞–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ, –∞ —è –ø–æ–ø—Ä–æ–±—É—é –µ–≥–æ —É–≥–∞–¥–∞—Ç—å!\n");
        printf("–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:\n");
        printf("  - –í–≤–µ–¥–∏—Ç–µ 'c' –µ—Å–ª–∏ –º–æ—è –¥–æ–≥–∞–¥–∫–∞ –ü–†–ê–í–ò–õ–¨–ù–ê\n");
        printf("  - –í–≤–µ–¥–∏—Ç–µ 'l' –µ—Å–ª–∏ –≤–∞—à–µ —á–∏—Å–ª–æ –ú–ï–ù–¨–®–ï –º–æ–µ–π –¥–æ–≥–∞–¥–∫–∏\n");
        printf("  - –í–≤–µ–¥–∏—Ç–µ 'h' –µ—Å–ª–∏ –≤–∞—à–µ —á–∏—Å–ª–æ –ë–û–õ–¨–®–ï –º–æ–µ–π –¥–æ–≥–∞–¥–∫–∏\n");
        printf("  - –í–≤–µ–¥–∏—Ç–µ 'q' —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã\n\n");

        low = 1;
        high = N;
        attempts = 0;
        int previous_low = 1;
        int previous_high = N;
        int game_active = 1; // –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–≥—Ä—ã

        while (low <= high && game_active) {
            guess = low + (high - low) / 2;
            attempts++;

            printf("\n=== –ü–æ–ø—ã—Ç–∫–∞ ‚Ññ%d ===\n", attempts);
            printf("–¢–µ–∫—É—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç %d –¥–æ %d\n", low, high);
            printf("–ú–æ—è –¥–æ–≥–∞–¥–∫–∞: %d\n", guess);
            printf("–í–∞—à –æ—Ç–≤–µ—Ç? (c/l/h/q): ");

            char feedback[3];
            while (1) {
                if (fgets(feedback, sizeof(feedback), stdin) == NULL) {
                    printf("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞.\n");
                    return 1;
                }
                // –£–¥–∞–ª—è–µ–º —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
                if (feedback[strlen(feedback) - 1] == '\n') {
                    feedback[strlen(feedback) - 1] = '\0';
                }

                if (feedback[0] == 'c' || feedback[0] == 'C' ||
                    feedback[0] == 'l' || feedback[0] == 'L' ||
                    feedback[0] == 'h' || feedback[0] == 'H' ||
                    feedback[0] == 'q' || feedback[0] == 'Q') {
                    break;
                }
                printf("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ 'c', 'l', 'h' –∏–ª–∏ 'q': ");
            }

            if (feedback[0] == 'c' || feedback[0] == 'C') {
                printf("\nüéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –Ø —É–≥–∞–¥–∞–ª –≤–∞—à–µ —á–∏—Å–ª–æ %d –∑–∞ %d –ø–æ–ø—ã—Ç–æ–∫!\n", guess, attempts);
                game_active = 0;
            }
            else if (feedback[0] == 'l' || feedback[0] == 'L') {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
                previous_low = low;
                previous_high = high;

                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É
                high = guess - 1;

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã—à–µ–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
                if (high < 1) {
                    printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                    printf("   –í—ã —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ 1, –Ω–æ –¥–∏–∞–ø–∞–∑–æ–Ω –±—ã–ª –æ—Ç 1 –¥–æ %d.\n", N);
                    printf("   –≠—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ! –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º...\n");

                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã
                    low = previous_low;
                    high = previous_high;
                    attempts--; // –ù–µ —Å—á–∏—Ç–∞–µ–º —ç—Ç—É –ø–æ–ø—ã—Ç–∫—É
                    continue;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–ª–∏—à–∫–æ–º –ª–∏ —Å–∏–ª—å–Ω–æ —Å—É–∑–∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω
                if (high < low) {
                    printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                    printf("   –¢–µ–ø–µ—Ä—å –¥–∏–∞–ø–∞–∑–æ–Ω –ø—É—Å—Ç–æ–π: –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ %d, –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ %d\n", low, high);
                    printf("   –≠—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ! –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º...\n");

                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã
                    low = previous_low;
                    high = previous_high;
                    attempts--; // –ù–µ —Å—á–∏—Ç–∞–µ–º —ç—Ç—É –ø–æ–ø—ã—Ç–∫—É
                    continue;
                }

                printf("–•–æ—Ä–æ—à–æ, –≤–∞—à–µ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ —á–µ–º %d. –ù–æ–≤—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç %d –¥–æ %d\n",
                    guess, low, high);
            }
            else if (feedback[0] == 'h' || feedback[0] == 'H') {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
                previous_low = low;
                previous_high = high;

                // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É
                low = guess + 1;

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã—à–µ–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
                if (low > N) {
                    printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                    printf("   –í—ã —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ %d, –Ω–æ –¥–∏–∞–ø–∞–∑–æ–Ω –±—ã–ª –æ—Ç 1 –¥–æ %d.\n", N, N);
                    printf("   –≠—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ! –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º...\n");

                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã
                    low = previous_low;
                    high = previous_high;
                    attempts--; // –ù–µ —Å—á–∏—Ç–∞–µ–º —ç—Ç—É –ø–æ–ø—ã—Ç–∫—É
                    continue;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–ª–∏—à–∫–æ–º –ª–∏ —Å–∏–ª—å–Ω–æ —Å—É–∑–∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω
                if (low > high) {
                    printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                    printf("   –¢–µ–ø–µ—Ä—å –¥–∏–∞–ø–∞–∑–æ–Ω –ø—É—Å—Ç–æ–π: –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ %d, –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ %d\n", low, high);
                    printf("   –≠—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ! –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º...\n");

                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã
                    low = previous_low;
                    high = previous_high;
                    attempts--; // –ù–µ —Å—á–∏—Ç–∞–µ–º —ç—Ç—É –ø–æ–ø—ã—Ç–∫—É
                    continue;
                }

                printf("–•–æ—Ä–æ—à–æ, –≤–∞—à–µ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ —á–µ–º %d. –ù–æ–≤—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç %d –¥–æ %d\n",
                    guess, low, high);
            }
            else if (feedback[0] == 'q' || feedback[0] == 'Q') {
                printf("\n–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ß–∏—Å–ª–æ –±—ã–ª–æ –º–µ–∂–¥—É %d –∏ %d.\n", low, high);
                game_active = 0;
            }

            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç–∞–ª —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–º
            if ((high - low) < 0 && game_active) {
                printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                printf("   –î–∏–∞–ø–∞–∑–æ–Ω —Å—Ç–∞–ª –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º! –í–∞—à–∏ –æ—Ç–≤–µ—Ç—ã –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É.\n");
                printf("   –ù–∞—á–∏–Ω–∞–µ–º —ç—Ç–æ—Ç —ç—Ç–∞–ø –∑–∞–Ω–æ–≤–æ...\n");

                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º
                low = previous_low;
                high = previous_high;
                attempts--;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —á–∏—Å–ª–æ
            if (low == high && game_active) {
                attempts++;
                printf("\n=== –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ ‚Ññ%d ===\n", attempts);
                printf("–í –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —á–∏—Å–ª–æ!\n");
                printf("–í–∞—à–µ —á–∏—Å–ª–æ –î–û–õ–ñ–ù–û –±—ã—Ç—å: %d\n", low);
                printf("–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —á–∏—Å–ª–æ? (y/n/q): ");

                char final_answer[3];
                while (1) {
                    if (fgets(final_answer, sizeof(final_answer), stdin) == NULL) {
                        printf("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞.\n");
                        return 1;
                    }
                    // –£–¥–∞–ª—è–µ–º —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
                    if (final_answer[strlen(final_answer) - 1] == '\n') {
                        final_answer[strlen(final_answer) - 1] = '\0';
                    }

                    if (final_answer[0] == 'y' || final_answer[0] == 'Y' ||
                        final_answer[0] == 'n' || final_answer[0] == 'N' ||
                        final_answer[0] == 'q' || final_answer[0] == 'Q') {
                        break;
                    }
                    printf("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ 'y', 'n' –∏–ª–∏ 'q': ");
                }

                if (final_answer[0] == 'y' || final_answer[0] == 'Y') {
                    printf("\nüéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –Ø —É–≥–∞–¥–∞–ª –≤–∞—à–µ —á–∏—Å–ª–æ %d –∑–∞ %d –ø–æ–ø—ã—Ç–æ–∫!\n", low, attempts);
                    game_active = 0;
                }
                else if (final_answer[0] == 'n' || final_answer[0] == 'N') {
                    printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                    printf("   –ï—Å–ª–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ %d, –∏ —ç—Ç–æ –Ω–µ –≤–∞—à–µ —á–∏—Å–ª–æ,\n", low);
                    printf("   —Ç–æ –≤–∞—à–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—Ç–≤–µ—Ç—ã –±—ã–ª–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–º–∏.\n");
                    printf("   –ò–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ...\n");

                    // –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–Ω–æ–≤–æ
                    low = 1;
                    high = N;
                    attempts = 0;
                    previous_low = 1;
                    previous_high = N;
                    printf("–ù–æ–≤–∞—è –∏–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å. –î–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç 1 –¥–æ %d\n", N);
                }
                else if (final_answer[0] == 'q' || final_answer[0] == 'Q') {
                    printf("\n–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.\n");
                    game_active = 0;
                }
            }
        }

        if (low > high && attempts > 0 && game_active) {
            printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
            printf("   –î–∏–∞–ø–∞–∑–æ–Ω –ø–æ–∏—Å–∫–∞ —Å—Ç–∞–ª –ø—É—Å—Ç—ã–º (–Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ %d > –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã %d).\n", low, high);
            printf("   –í–∞—à–∏ –æ—Ç–≤–µ—Ç—ã –±—ã–ª–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–º–∏. –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.\n");
        }
    }
    else {
        printf("–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≥–∞–¥–∞—Ç—å –º–æ–µ —á–∏—Å–ª–æ!\n");
        printf("–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:\n");
        printf("  - –Ø —Å–∫–∞–∂—É 'LT' –µ—Å–ª–∏ –≤–∞—à–∞ –¥–æ–≥–∞–¥–∫–∞ –°–õ–ò–®–ö–û–ú –ú–ê–õ–ê\n");
        printf("  - –Ø —Å–∫–∞–∂—É 'GT' –µ—Å–ª–∏ –≤–∞—à–∞ –¥–æ–≥–∞–¥–∫–∞ –°–õ–ò–®–ö–û–ú –í–ï–õ–ò–ö–ê\n");
        printf("  - –Ø —Å–∫–∞–∂—É 'EQ' –µ—Å–ª–∏ –≤—ã —É–≥–∞–¥–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ\n\n");

        attempts = 0;
        int previous_guess = 0;
        int direction_changes = 0;
        int guessing_active = 1;

        do {
            printf("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É –¥–æ–≥–∞–¥–∫—É (–æ—Ç 1 –¥–æ %d): ", N);
            guess = get_valid_integer(1, N);
            attempts++;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–µ –¥–æ–≥–∞–¥–∫–∏
            if (attempts > 1) {
                if ((previous_guess < secret_number && guess > secret_number && guess > previous_guess) ||
                    (previous_guess > secret_number && guess < secret_number && guess < previous_guess)) {
                    direction_changes++;

                    if (direction_changes > 3) {
                        printf("\n‚ö†Ô∏è –¢–æ–≤–∞—Ä–∏—â, –≤—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ —É—à–ª–∏!\n");
                        printf("   –í—ã –º–Ω–æ–≥–æ —Ä–∞–∑ –º–µ–Ω—è–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞.\n");
                        printf("   –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±—ã—Ç—å –±–æ–ª–µ–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º!\n");
                    }
                }
            }
            previous_guess = guess;

            if (guess < secret_number) {
                printf("LT (—Å–ª–∏—à–∫–æ–º –º–∞–ª–æ)\n");
            }
            else if (guess > secret_number) {
                printf("GT (—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ)\n");
            }
            else {
                printf("EQ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ!)\n");
                printf("\nüéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –í—ã —É–≥–∞–¥–∞–ª–∏ —á–∏—Å–ª–æ %d –∑–∞ %d –ø–æ–ø—ã—Ç–æ–∫!\n",
                    secret_number, attempts);
                guessing_active = 0;
            }
        } while (guessing_active);
    }

    printf("\n=== –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã ===\n");
    printf("–î–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç 1 –¥–æ %d\n", N);
    printf("–í—Å–µ–≥–æ –ø–æ–ø—ã—Ç–æ–∫: %d\n", attempts);

    if (strategy_choice[0] == 'y' || strategy_choice[0] == 'Y') {
        printf("–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:\n");
        printf("–ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —É–º–µ–Ω—å—à–∞–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ –≤–¥–≤–æ–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑.\n");
        printf("–î–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 1..%d, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –ø–æ–ø—ã—Ç–æ–∫: %d\n",
            N, (int)(log(N) / log(2)) + 1);
        printf("–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏: O(log N)\n");
    }
    else {
        printf("–í–∞—à–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫ (–º–µ—Ç–æ–¥ –ø—Ä–æ–± –∏ –æ—à–∏–±–æ–∫)\n");
        printf("–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω–æ–º —É–≥–∞–¥—ã–≤–∞–Ω–∏–∏: ~%d\n", N / 2);
        printf("–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏: O(N)\n");
    }

    printf("\n=== –°–æ–≤–µ—Ç—ã –Ω–∞ –±—É–¥—É—â–µ–µ ===\n");
    printf("1. –ë—É–¥—å—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã –≤ —Å–≤–æ–∏—Ö –æ—Ç–≤–µ—Ç–∞—Ö\n");
    printf("2. –ü–æ–º–Ω–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (–æ—Ç 1 –¥–æ %d)\n", N);
    printf("3. –ù–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á—å—Ç–µ —Å–≤–æ–∏–º –ø—Ä–µ–¥—ã–¥—É—â–∏–º –æ—Ç–≤–µ—Ç–∞–º\n");
    printf("4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏\n");

    printf("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...");
    getchar(); // –ñ–¥–µ–º –Ω–∞–∂–∞—Ç–∏—è Enter –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º

    return 0;
}
